From d74db4bb4fa90b3ca74848e4a32331ca55d976e6 Mon Sep 17 00:00:00 2001
From: Philippe Normand <philn@igalia.com>
Date: Mon, 20 Jan 2025 12:16:16 +0000
Subject: [PATCH] GStreamer: Vendor SDP patch scheduled to ship in 1.24.12

---
 ...-attribute-value-represented-as-a-NU.patch | 31 +++++++++++++++++++
 1 file changed, 31 insertions(+)
 create mode 100644 patches/gstreamer/gst-plugins-bad-0009-sdp-accept-empty-attribute-value-represented-as-a-NU.patch

diff --git a/patches/gstreamer/gst-plugins-bad-0009-sdp-accept-empty-attribute-value-represented-as-a-NU.patch b/patches/gstreamer/gst-plugins-bad-0009-sdp-accept-empty-attribute-value-represented-as-a-NU.patch
new file mode 100644
index 0000000..0e93d4d
--- /dev/null
+++ b/patches/gstreamer/gst-plugins-bad-0009-sdp-accept-empty-attribute-value-represented-as-a-NU.patch
@@ -0,0 +1,31 @@
+From 8c829fdc37486abd0dac2729020bcdeb33f25e77 Mon Sep 17 00:00:00 2001
+From: =?UTF-8?q?Fran=C3=A7ois=20Laignel?= <francois@centricular.com>
+Date: Fri, 23 Feb 2024 15:20:41 +0100
+Subject: [PATCH] sdp: accept empty attribute value represented as a NULL
+ pointer
+
+Some empty media attribute values are set to an empty string, others as a NULL
+pointer. It seems that code is able to deal with both, except for the UTF8
+validation.
+
+Part-of: <https://gitlab.freedesktop.org/gstreamer/gstreamer/-/merge_requests/6119>
+---
+ subprojects/gst-plugins-base/gst-libs/gst/sdp/gstsdpmessage.c | 2 +-
+ 1 file changed, 1 insertion(+), 1 deletion(-)
+
+diff --git a/subprojects/gst-plugins-base/gst-libs/gst/sdp/gstsdpmessage.c b/subprojects/gst-plugins-base/gst-libs/gst/sdp/gstsdpmessage.c
+index a08bbc96d1..96ed5fd5a2 100644
+--- a/subprojects/gst-plugins-base/gst-libs/gst/sdp/gstsdpmessage.c
++++ b/subprojects/gst-plugins-base/gst-libs/gst/sdp/gstsdpmessage.c
+@@ -4278,7 +4278,7 @@ sdp_add_attributes_to_caps (GArray * attributes, GstCaps * caps)
+         continue;
+ 
+       /* string must be valid UTF8 */
+-      if (!g_utf8_validate (attr->value, -1, NULL))
++      if (attr->value != NULL && !g_utf8_validate (attr->value, -1, NULL))
+         continue;
+ 
+       if (!g_str_has_prefix (key, "x-"))
+-- 
+2.47.1
+
-- 
2.48.0

