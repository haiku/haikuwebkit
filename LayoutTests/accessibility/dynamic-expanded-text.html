<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<html>
<head>
<script src="../resources/accessibility-helper.js"></script>
<script src="../resources/js-test.js"></script>
</head>
<body>

<abbr id="abbr" title="Laughing out loud">LOL</abbr>

<script>
var output = "This test ensures the expanded-text value of an abbreviation is updated after dynamic page changes.\n\n";

if (window.accessibilityController) {
    window.jsTestIsAsync = true;

    var webarea = accessibilityController.rootElement.childAtIndex(0);
    var text = webarea.childAtIndex(0);
    output += expect("text.stringAttributeValue('AXExpandedTextValue')", "'Laughing out loud'");
    if (accessibilityController.platformName === "mac")
        output += expect("text.isAttributeSupported('AXExpandedTextValue')", "true");

    document.getElementById("abbr").setAttribute("title", "Lots of luck");
    setTimeout(async function() {
        output += await expectAsync("text.stringAttributeValue('AXExpandedTextValue')", "'Lots of luck'");

        debug(output);
        finishJSTest();
    }, 0);
}
</script>
</body>
</html>

